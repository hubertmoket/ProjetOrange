listEntite = {"DOF":0, "GE":0, "ISE":0, "NC":0, "NF":0, "OA":0, "PARIS":0, "AURA":0, "RM":0, "SO":0, "OC":0};

dataBeginModif = 
[
    {'entite':'DOF', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'GE', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'ISE', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'NC', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'NF', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'OA', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'PARIS', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'AURA', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'RM', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'SO', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'OC', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'comment':'', 
    'entraide':'', 'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''}
];

dataBeginResil = 
[
    {'entite':'DOF', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'GE', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'ISE', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'NC', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'NF', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'OA', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'PARIS', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'AURA', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'RM', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'S0', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''},
    {'entite':'OC', 'instance':'', 'affect':'', 'ADSL':'', 'nonADSL':'', 'BIC':'', 'EGO':'', 'comment':'', 'entraide':'', 
    'quantAE':'', 'entAE':'', 'majo':'', 'sitel':''}
];

dataTestModif = 
[
    {'entite':'DOF', 'instance':'1234', 'affect':'53453', 'ADSL':'543543', 'nonADSL':'54353', 'comment':'test', 
    'entraide':'64564', 'quantAE':'534534', 'entAE':'AE', 'majo':'5353', 'sitel':'52345646'},
    {'entite':'ISE', 'instance':'1234', 'affect':'53453', 'ADSL':'543543', 'nonADSL':'54353', 'comment':'test', 
    'entraide':'64564', 'quantAE':'534534', 'entAE':'AE', 'majo':'5353', 'sitel':'52345646'},
    {'entite':'NC', 'instance':'1234', 'affect':'53453', 'ADSL':'543543', 'nonADSL':'54353', 'comment':'test', 
    'entraide':'64564', 'quantAE':'534534', 'entAE':'AE', 'majo':'5353', 'sitel':'52345646'},
    {'entite':'NF', 'instance':'1234', 'affect':'53453', 'ADSL':'543543', 'nonADSL':'54353', 'comment':'test', 
    'entraide':'64564', 'quantAE':'534534', 'entAE':'AE', 'majo':'5353', 'sitel':'52345646'},
    {'entite':'PARIS', 'instance':'1234', 'affect':'53453', 'ADSL':'543543', 'nonADSL':'54353', 'comment':'test', 
    'entraide':'64564', 'quantAE':'534534', 'entAE':'AE', 'majo':'5353', 'sitel':'52345646'}
];

dataTestResil = 
[
    {'entite':'DOF', 'instance':'0', 'affect':'0', 'ADSL':'0', 'nonADSL':'0', 'BIC':'0',
     'EGO':'0', 'comment':'', 'entraide':'0', 'quantAE':'0', 'entAE':'', 'majo':'0', 
     'sitel':'0'},
     {'entite':'GE', 'instance':'10', 'affect':'9', 'ADSL':'1', 'nonADSL':'0', 'BIC':'0',
     'EGO':'0', 'comment':'', 'entraide':'0', 'quantAE':'0', 'entAE':'', 'majo':'0', 
     'sitel':'0'},
     {'entite':'AURA', 'instance':'0', 'affect':'0', 'ADSL':'0', 'nonADSL':'0', 'BIC':'0',
     'EGO':'0', 'comment':'', 'entraide':'0', 'quantAE':'0', 'entAE':'', 'majo':'0', 
     'sitel':'0'},
     {'entite':'NF', 'instance':'0', 'affect':'0', 'ADSL':'0', 'nonADSL':'0', 'BIC':'0',
     'EGO':'0', 'comment':'', 'entraide':'0', 'quantAE':'0', 'entAE':'', 'majo':'0', 
     'sitel':'0'},
     {'entite':'SO', 'instance':'0', 'affect':'0', 'ADSL':'0', 'nonADSL':'0', 'BIC':'0',
     'EGO':'0', 'comment':'', 'entraide':'0', 'quantAE':'0', 'entAE':'', 'majo':'0', 
     'sitel':'0'},
];

//vide le tableau en gardant l'entete
function clearTable(){
    let tableData = document.getElementById("tableData");
    let myTable = document.getElementById("myTable");
    if(tableData != null && tableData.value != ''){
        myTable.removeChild(tableData);
    }  
}

//construit le tableau en fonction des data
function addData(data, type){
    clearTable();
    let myTable = document.getElementById("myTable");
    let myTbody = document.createElement('tbody');
    myTbody.id = "tableData";

    data.forEach(element => {
        if(element.entite in listEntite){
            listEntite[element.entite] = element;
        }       
    });

    Object.keys(listEntite).forEach(element => {
        if(type == 'modif'){
            if(ligneEstVide(listEntite[element]))
            {
                myTbody = addLineModifData(myTbody, element, 0, 0, 0, 0, "", 0, 0, "", 0, 0);
            }else{
                myTbody = addLineModifData(myTbody, listEntite[element].entite, listEntite[element].instance, 
                    listEntite[element].affect, listEntite[element].ADSL, listEntite[element].nonADSL, listEntite[element].comment,
                    listEntite[element].entraide, listEntite[element].quantAE, listEntite[element].entAE, listEntite[element].majo, 
                    listEntite[element].sitel);
            }
        }else{
            if(ligneEstVide(listEntite[element]))
            {
                myTbody = addLineResilData(myTbody, element, 0, 0, 0, 0, 0, 0, "", 0, 0, "", 0, 0);
            }else{
                myTbody = addLineResilData(myTbody, listEntite[element].entite, listEntite[element].instance, 
                    listEntite[element].affect, listEntite[element].ADSL, listEntite[element].BIC, listEntite[element].EGO, 
                    listEntite[element].nonADSL, listEntite[element].comment, listEntite[element].entraide, 
                    listEntite[element].quantAE, listEntite[element].entAE, listEntite[element].majo, listEntite[element].sitel);
            }
        }
             
    });

    myTable.appendChild(myTbody);
}

function addLineModifData(myTbody, entite, instance, affect, ADSL, nonADSL, comment, entraide, quantAE, entAE, majo, sitel){
    let myLigne = document.createElement('tr');
    myLigne.innerHTML = '<td  class="table-light">'+entite+'</td>' + '\n' +
    '<td>'+instance+'</td>' + '\n' +
    '<td>'+affect+'</td>' + '\n' +
    '<td class="table-light">'+ADSL+'</td>' + '\n' +
    '<td class="table-light">'+nonADSL+'</td>' + '\n' +
    '<td>'+comment+'</td>' + '\n' +
    '<td class="table-light">'+entraide+'</td>' + '\n' +
    '<td>'+quantAE+'</td>' + '\n' +
    '<td>'+entAE+'</td>' + '\n' +
    '<td>'+majo+'</td>' + '\n' +
    '<td>'+sitel+'</td>' + '\n';

    myTbody.appendChild(myLigne);
    return myTbody;
}

function addLineResilData(myTbody, entite, instance, affect, ADSL, nonADSL, BIC, EGO, comment, entraide, quantAE, 
    entAE, majo, sitel){
    let myLigne = document.createElement('tr');
    myLigne.innerHTML = '<td  class="table-light">'+entite+'</td>' + '\n' +
    '<td>'+instance+'</td>' + '\n' +
    '<td>'+affect+'</td>' + '\n' +
    '<td class="table-light">'+ADSL+'</td>' + '\n' +
    '<td class="table-light">'+nonADSL+'</td>' + '\n' +
    '<td class="table-light">'+BIC+'</td>' + '\n' +
    '<td class="table-light">'+EGO+'</td>' + '\n' +
    '<td>'+comment+'</td>' + '\n' +
    '<td class="table-light">'+entraide+'</td>' + '\n' +
    '<td>'+quantAE+'</td>' + '\n' +
    '<td>'+entAE+'</td>' + '\n' +
    '<td>'+majo+'</td>' + '\n' +
    '<td>'+sitel+'</td>' + '\n';

    myTbody.appendChild(myLigne);
    return myTbody;
}

function ligneEstVide(ligne){

    estVide = true;
    Object.keys(ligne).forEach(element => {
        if(element != 'entite' && ligne[element] != "")
        {
            estVide = false;
        }
    });
    return estVide;
}
